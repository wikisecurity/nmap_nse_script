# http-react2shell-footprint.nse

### Overview  

WIKI Security Lab takes part in multiple bug bounty programs and openly releases newly developed vulnerability PoCs as Nmap NSE scripts for the community to use.  
http-react2shell-footprint.nse is a non-destructive Nmap NSE script designed to identify
Next.js / React Server Components (RSC) footprints that may indicate exposure related to React2Shell (CVE-2025-55182).  
This script performs **unauthenticated, external-facing checks only** and does **not** attempt exploitation or command execution.  
Its purpose is to help security teams **pre-filter and prioritize targets** for further manual review or controlled vulnerability assessment.


### Key Characteristics
- Port-agnostic: runs on **any port detected as HTTP or HTTPS**
- Unauthenticated: no credentials required
- External-facing: suitable for internet-exposed asset assessments
- Non-destructive: no exploit payloads, no state-changing requests
- Evidence-based scoring to reduce false positives
- Compatible with **Nmap 7.80 (Lua 5.3)** and later


### Detection Logic (High-Level)
The script uses a **multi-signal footprinting approach**, combining several weak indicators
into a weighted score.

### Signals Collected
- Presence of Next.js-specific paths such as:
  - `/_next/`
  - `/_next/static/`
  - `/_next/image`
- HTML body markers:
  - `__NEXT_DATA__`
  - `id="__next"`
  - Other Next.js / React-related tokens
- HTTP response headers:
  - `x-powered-by: Next.js`
  - `x-nextjs-*` headers (when present)
- Rare but strong indicators:
  - `Content-Type: text/x-component` (React Server Components)

### Verdict Levels
The script does **not** claim confirmed vulnerability.  
Instead, it classifies targets as:
- `POSSIBLE (strong Next.js/RSC footprint)`
- `POSSIBLE (moderate footprint)`
- `INCONCLUSIVE (weak footprint)`
- `NOT_DETECTED`
Each result includes **explicit evidence lines** explaining why the score was assigned.


### Usage
- For single hosts:  
 `nmap -sV -p- --open --script http-react2shell-footprint.nse <targets>`

- For hosts using name-based virtual hosting:  
 `nmap -sV -p 443 --script http-react2shell-footprint.nse --script-args http.host=example.com <target>`

### Example Output
```text
Starting Nmap 7.80 ( https://nmap.org ) at 2026-01-15 17:10 KST
Nmap scan report for react.example.com (192.168.1.102)
Host is up (0.42s latency).

PORT   STATE SERVICE VERSION  
80/tcp open  http    Apache httpd 2.4.58 ((Ubuntu))  
| http-reactrshell-footprint:  
|  POSSIBLE (strong Next.js/RSC footprint)  
|  score=9  
|  limits: max_redirects=2, max_body_bytes=204800  
|  evidence:  
|    - (+3) content-type: text/x-component | Observed RSC content-type  
|    - (+2) html: /_next/ found | Found '/_next/' reference in response body  
|    - (+2) html: __NEXT_DATA__ found | Found '__NEXT_DATA__' marker  
|    - (+1) x-powered-by: Next.js  
| _ note: This is a footprint/exposure check only. Patch/mitigate if service is confirmed affected.  
| _ http-server-header:  Apache/2.4.58 (Ubuntu)
```

### Limitations
- This script does not confirm exploitation
- Version detection for Next.js is intentionally avoided due to reliability issues
- CDN, WAF, or reverse proxies may hide or alter some indicators
- A POSSIBLE result requires manual validation

### Legal and Ethical Notice
This script is provided for authorized security testing and research purposes only.
- Scan only systems you own or have explicit permission to test
- Do not use this script to perform exploitation or denial-of-service attacks
- The author assumes no liability for misuse

### License
- Same license as Nmap.
- See: https://nmap.org/book/man-legal.html
